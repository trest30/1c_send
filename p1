Процедура СообщенияПриЗаписи(Источник, Отказ, Замещение) Экспорт
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Сообщения.Текст
	|ИЗ
	|	РегистрСведений.Сообщения КАК Сообщения
	|ГДЕ
	|	Сообщения.Пользователь = &Пользователь";
	
	Запрос.УстановитьПараметр("Пользователь", ПараметрыСеанса.ТекущийПользователь);
	Результат = Запрос.Выполнить();
	
	Если НЕ Результат.Пустой() Тогда
		Выборка = Результат.Выбрать();
		Выборка.Следующий();
		Предупреждение(Выборка.Текст,,"Сообщение для " + ПараметрыСеанса.ТекущийПользователь);
		Набор = РегистрыСведений.Сообщения.СоздатьНаборЗаписей();
		Набор.Отбор.Пользователь.Установить(ПараметрыСеанса.ТекущийПользователь);
		Набор.Записать();
	КонецЕсли;
КонецПроцедуры

Процедура ПроверкаАктивностиПользователяПередЗаписью(Источник, Отказ, Замещение) Экспорт
	СоединенияИнформационнойБазы = ПолучитьСоединенияИнформационнойБазы();	
	Активен = Ложь;
	Для Каждого Соединение Из СоединенияИнформационнойБазы Цикл  
		
		Если Соединение.Пользователь.ПолноеИмя = Источник.Отбор.Пользователь.Значение.Наименование тогда
			Активен = Истина;                      		
		КонецЕсли;	                         		
	КонецЦикла;
	Если Не Активен Тогда
		Сообщить("Пользователь " + Источник.Отбор.Пользователь.Значение.Наименование + " не активен. Сообщение ему отправить нельзя");
		Возврат;
	КонецЕсли;
	
КонецПроцедуры


